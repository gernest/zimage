const color = @import("color.zig");
const t = @import("../util/index.zig");

const TestCase = struct {
    x: u32,
    y: u32,
    expect: u32,
};

const test_cases = []TestCase{
    TestCase{ .x = 0x0, .y = 0x0, .expect = 0x0 },
    TestCase{ .x = 0x0, .y = 0x1, .expect = 0x0 },
    TestCase{ .x = 0x0, .y = 0x2, .expect = 0x1 },
    TestCase{ .x = 0x0, .y = 0xfffd, .expect = 0x3ffe8002 },
    TestCase{ .x = 0x0, .y = 0xfffe, .expect = 0x3fff0001 },
    TestCase{ .x = 0x0, .y = 0xffff, .expect = 0x3fff8000 },
    TestCase{ .x = 0x0, .y = 0x10000, .expect = 0x0 },
    TestCase{ .x = 0x0, .y = 0x10001, .expect = 0x8000 },
    TestCase{ .x = 0x0, .y = 0x10002, .expect = 0x10001 },
    TestCase{ .x = 0x0, .y = 0xfffffffd, .expect = 0x2 },
    TestCase{ .x = 0x0, .y = 0xfffffffe, .expect = 0x1 },
    TestCase{ .x = 0x0, .y = 0xffffffff, .expect = 0x0 },
    TestCase{ .x = 0x1, .y = 0x0, .expect = 0x0 },
    TestCase{ .x = 0x1, .y = 0x1, .expect = 0x0 },
    TestCase{ .x = 0x1, .y = 0x2, .expect = 0x0 },
    TestCase{ .x = 0x1, .y = 0xfffd, .expect = 0x3ffe0004 },
    TestCase{ .x = 0x1, .y = 0xfffe, .expect = 0x3ffe8002 },
    TestCase{ .x = 0x1, .y = 0xffff, .expect = 0x3fff0001 },
    TestCase{ .x = 0x1, .y = 0x10000, .expect = 0x3fff8000 },
    TestCase{ .x = 0x1, .y = 0x10001, .expect = 0x0 },
    TestCase{ .x = 0x1, .y = 0x10002, .expect = 0x8000 },
    TestCase{ .x = 0x1, .y = 0xfffffffd, .expect = 0x4 },
    TestCase{ .x = 0x1, .y = 0xfffffffe, .expect = 0x2 },
    TestCase{ .x = 0x1, .y = 0xffffffff, .expect = 0x1 },
    TestCase{ .x = 0x2, .y = 0x0, .expect = 0x1 },
    TestCase{ .x = 0x2, .y = 0x1, .expect = 0x0 },
    TestCase{ .x = 0x2, .y = 0x2, .expect = 0x0 },
    TestCase{ .x = 0x2, .y = 0xfffd, .expect = 0x3ffd8006 },
    TestCase{ .x = 0x2, .y = 0xfffe, .expect = 0x3ffe0004 },
    TestCase{ .x = 0x2, .y = 0xffff, .expect = 0x3ffe8002 },
    TestCase{ .x = 0x2, .y = 0x10000, .expect = 0x3fff0001 },
    TestCase{ .x = 0x2, .y = 0x10001, .expect = 0x3fff8000 },
    TestCase{ .x = 0x2, .y = 0x10002, .expect = 0x0 },
    TestCase{ .x = 0x2, .y = 0xfffffffd, .expect = 0x6 },
    TestCase{ .x = 0x2, .y = 0xfffffffe, .expect = 0x4 },
    TestCase{ .x = 0x2, .y = 0xffffffff, .expect = 0x2 },
    TestCase{ .x = 0xfffd, .y = 0x0, .expect = 0x3ffe8002 },
    TestCase{ .x = 0xfffd, .y = 0x1, .expect = 0x3ffe0004 },
    TestCase{ .x = 0xfffd, .y = 0x2, .expect = 0x3ffd8006 },
    TestCase{ .x = 0xfffd, .y = 0xfffd, .expect = 0x0 },
    TestCase{ .x = 0xfffd, .y = 0xfffe, .expect = 0x0 },
    TestCase{ .x = 0xfffd, .y = 0xffff, .expect = 0x1 },
    TestCase{ .x = 0xfffd, .y = 0x10000, .expect = 0x2 },
    TestCase{ .x = 0xfffd, .y = 0x10001, .expect = 0x4 },
    TestCase{ .x = 0xfffd, .y = 0x10002, .expect = 0x6 },
    TestCase{ .x = 0xfffd, .y = 0xfffffffd, .expect = 0x0 },
    TestCase{ .x = 0xfffd, .y = 0xfffffffe, .expect = 0x3fff8000 },
    TestCase{ .x = 0xfffd, .y = 0xffffffff, .expect = 0x3fff0001 },
    TestCase{ .x = 0xfffe, .y = 0x0, .expect = 0x3fff0001 },
    TestCase{ .x = 0xfffe, .y = 0x1, .expect = 0x3ffe8002 },
    TestCase{ .x = 0xfffe, .y = 0x2, .expect = 0x3ffe0004 },
    TestCase{ .x = 0xfffe, .y = 0xfffd, .expect = 0x0 },
    TestCase{ .x = 0xfffe, .y = 0xfffe, .expect = 0x0 },
    TestCase{ .x = 0xfffe, .y = 0xffff, .expect = 0x0 },
    TestCase{ .x = 0xfffe, .y = 0x10000, .expect = 0x1 },
    TestCase{ .x = 0xfffe, .y = 0x10001, .expect = 0x2 },
    TestCase{ .x = 0xfffe, .y = 0x10002, .expect = 0x4 },
    TestCase{ .x = 0xfffe, .y = 0xfffffffd, .expect = 0x8000 },
    TestCase{ .x = 0xfffe, .y = 0xfffffffe, .expect = 0x0 },
    TestCase{ .x = 0xfffe, .y = 0xffffffff, .expect = 0x3fff8000 },
    TestCase{ .x = 0xffff, .y = 0x0, .expect = 0x3fff8000 },
    TestCase{ .x = 0xffff, .y = 0x1, .expect = 0x3fff0001 },
    TestCase{ .x = 0xffff, .y = 0x2, .expect = 0x3ffe8002 },
    TestCase{ .x = 0xffff, .y = 0xfffd, .expect = 0x1 },
    TestCase{ .x = 0xffff, .y = 0xfffe, .expect = 0x0 },
    TestCase{ .x = 0xffff, .y = 0xffff, .expect = 0x0 },
    TestCase{ .x = 0xffff, .y = 0x10000, .expect = 0x0 },
    TestCase{ .x = 0xffff, .y = 0x10001, .expect = 0x1 },
    TestCase{ .x = 0xffff, .y = 0x10002, .expect = 0x2 },
    TestCase{ .x = 0xffff, .y = 0xfffffffd, .expect = 0x10001 },
    TestCase{ .x = 0xffff, .y = 0xfffffffe, .expect = 0x8000 },
    TestCase{ .x = 0xffff, .y = 0xffffffff, .expect = 0x0 },
    TestCase{ .x = 0x10000, .y = 0x0, .expect = 0x0 },
    TestCase{ .x = 0x10000, .y = 0x1, .expect = 0x3fff8000 },
    TestCase{ .x = 0x10000, .y = 0x2, .expect = 0x3fff0001 },
    TestCase{ .x = 0x10000, .y = 0xfffd, .expect = 0x2 },
    TestCase{ .x = 0x10000, .y = 0xfffe, .expect = 0x1 },
    TestCase{ .x = 0x10000, .y = 0xffff, .expect = 0x0 },
    TestCase{ .x = 0x10000, .y = 0x10000, .expect = 0x0 },
    TestCase{ .x = 0x10000, .y = 0x10001, .expect = 0x0 },
    TestCase{ .x = 0x10000, .y = 0x10002, .expect = 0x1 },
    TestCase{ .x = 0x10000, .y = 0xfffffffd, .expect = 0x18002 },
    TestCase{ .x = 0x10000, .y = 0xfffffffe, .expect = 0x10001 },
    TestCase{ .x = 0x10000, .y = 0xffffffff, .expect = 0x8000 },
    TestCase{ .x = 0x10001, .y = 0x0, .expect = 0x8000 },
    TestCase{ .x = 0x10001, .y = 0x1, .expect = 0x0 },
    TestCase{ .x = 0x10001, .y = 0x2, .expect = 0x3fff8000 },
    TestCase{ .x = 0x10001, .y = 0xfffd, .expect = 0x4 },
    TestCase{ .x = 0x10001, .y = 0xfffe, .expect = 0x2 },
    TestCase{ .x = 0x10001, .y = 0xffff, .expect = 0x1 },
    TestCase{ .x = 0x10001, .y = 0x10000, .expect = 0x0 },
    TestCase{ .x = 0x10001, .y = 0x10001, .expect = 0x0 },
    TestCase{ .x = 0x10001, .y = 0x10002, .expect = 0x0 },
    TestCase{ .x = 0x10001, .y = 0xfffffffd, .expect = 0x20004 },
    TestCase{ .x = 0x10001, .y = 0xfffffffe, .expect = 0x18002 },
    TestCase{ .x = 0x10001, .y = 0xffffffff, .expect = 0x10001 },
    TestCase{ .x = 0x10002, .y = 0x0, .expect = 0x10001 },
    TestCase{ .x = 0x10002, .y = 0x1, .expect = 0x8000 },
    TestCase{ .x = 0x10002, .y = 0x2, .expect = 0x0 },
    TestCase{ .x = 0x10002, .y = 0xfffd, .expect = 0x6 },
    TestCase{ .x = 0x10002, .y = 0xfffe, .expect = 0x4 },
    TestCase{ .x = 0x10002, .y = 0xffff, .expect = 0x2 },
    TestCase{ .x = 0x10002, .y = 0x10000, .expect = 0x1 },
    TestCase{ .x = 0x10002, .y = 0x10001, .expect = 0x0 },
    TestCase{ .x = 0x10002, .y = 0x10002, .expect = 0x0 },
    TestCase{ .x = 0x10002, .y = 0xfffffffd, .expect = 0x28006 },
    TestCase{ .x = 0x10002, .y = 0xfffffffe, .expect = 0x20004 },
    TestCase{ .x = 0x10002, .y = 0xffffffff, .expect = 0x18002 },
    TestCase{ .x = 0xfffffffd, .y = 0x0, .expect = 0x2 },
    TestCase{ .x = 0xfffffffd, .y = 0x1, .expect = 0x4 },
    TestCase{ .x = 0xfffffffd, .y = 0x2, .expect = 0x6 },
    TestCase{ .x = 0xfffffffd, .y = 0xfffd, .expect = 0x0 },
    TestCase{ .x = 0xfffffffd, .y = 0xfffe, .expect = 0x8000 },
    TestCase{ .x = 0xfffffffd, .y = 0xffff, .expect = 0x10001 },
    TestCase{ .x = 0xfffffffd, .y = 0x10000, .expect = 0x18002 },
    TestCase{ .x = 0xfffffffd, .y = 0x10001, .expect = 0x20004 },
    TestCase{ .x = 0xfffffffd, .y = 0x10002, .expect = 0x28006 },
    TestCase{ .x = 0xfffffffd, .y = 0xfffffffd, .expect = 0x0 },
    TestCase{ .x = 0xfffffffd, .y = 0xfffffffe, .expect = 0x0 },
    TestCase{ .x = 0xfffffffd, .y = 0xffffffff, .expect = 0x1 },
    TestCase{ .x = 0xfffffffe, .y = 0x0, .expect = 0x1 },
    TestCase{ .x = 0xfffffffe, .y = 0x1, .expect = 0x2 },
    TestCase{ .x = 0xfffffffe, .y = 0x2, .expect = 0x4 },
    TestCase{ .x = 0xfffffffe, .y = 0xfffd, .expect = 0x3fff8000 },
    TestCase{ .x = 0xfffffffe, .y = 0xfffe, .expect = 0x0 },
    TestCase{ .x = 0xfffffffe, .y = 0xffff, .expect = 0x8000 },
    TestCase{ .x = 0xfffffffe, .y = 0x10000, .expect = 0x10001 },
    TestCase{ .x = 0xfffffffe, .y = 0x10001, .expect = 0x18002 },
    TestCase{ .x = 0xfffffffe, .y = 0x10002, .expect = 0x20004 },
    TestCase{ .x = 0xfffffffe, .y = 0xfffffffd, .expect = 0x0 },
    TestCase{ .x = 0xfffffffe, .y = 0xfffffffe, .expect = 0x0 },
    TestCase{ .x = 0xfffffffe, .y = 0xffffffff, .expect = 0x0 },
    TestCase{ .x = 0xffffffff, .y = 0x0, .expect = 0x0 },
    TestCase{ .x = 0xffffffff, .y = 0x1, .expect = 0x1 },
    TestCase{ .x = 0xffffffff, .y = 0x2, .expect = 0x2 },
    TestCase{ .x = 0xffffffff, .y = 0xfffd, .expect = 0x3fff0001 },
    TestCase{ .x = 0xffffffff, .y = 0xfffe, .expect = 0x3fff8000 },
    TestCase{ .x = 0xffffffff, .y = 0xffff, .expect = 0x0 },
    TestCase{ .x = 0xffffffff, .y = 0x10000, .expect = 0x8000 },
    TestCase{ .x = 0xffffffff, .y = 0x10001, .expect = 0x10001 },
    TestCase{ .x = 0xffffffff, .y = 0x10002, .expect = 0x18002 },
    TestCase{ .x = 0xffffffff, .y = 0xfffffffd, .expect = 0x1 },
    TestCase{ .x = 0xffffffff, .y = 0xfffffffe, .expect = 0x0 },
    TestCase{ .x = 0xffffffff, .y = 0xffffffff, .expect = 0x0 },
};

test "sqdiff" {
    for (test_cases) |v, idx| {
        const got = color.sqdiff(v.x, v.y);
        if (got != v.expect) {
            try t.terrorf("#{} want 0{x} got 0x{x}", idx, v.expect, got);
        }
    }
}
